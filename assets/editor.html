<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Este arquivo é mantido como referência, mas o app usa uma versão inline que injeta os assets locais via expo-asset -->
  <link rel="stylesheet" href="./editor/quill.snow.cssasset">
  <style>
    body { margin: 0; padding: 12px; font-family: -apple-system, 'Segoe UI', sans-serif; background: #fff; }
    #toolbar { border: 1px solid #e5e7eb; border-radius: 8px 8px 0 0; }
    #editor { min-height: 200px; border: 1px solid #e5e7eb; border-top: none; border-radius: 0 0 8px 8px; padding: 12px; }
  </style>
</head>
<body>
  <div id="toolbar">
    <select class="ql-header"><option value="1"></option><option value="2"></option><option selected></option></select>
    <button class="ql-bold"></button><button class="ql-italic"></button><button class="ql-underline"></button>
    <button class="ql-list" value="ordered"></button><button class="ql-list" value="bullet"></button>
    <select class="ql-color"></select><select class="ql-background"></select>
    <button class="ql-link"></button>
  </div>
  <div id="editor"></div>
  <script src="./editor/quill.min.jsbundle"></script>
  <script>
    const RN = window.ReactNativeWebView;
    const quill = new Quill('#editor', {
      theme: 'snow',
      modules: { toolbar: '#toolbar' },
    });
    const send = (msg) => RN && RN.postMessage(JSON.stringify(msg));
    send({ type: 'ready' });
    quill.on('text-change', () => {
      send({ type: 'change', html: quill.root.innerHTML, delta: quill.getContents() });
    });
    const setContent = (html) => {
      quill.root.innerHTML = html || '';
    };
    const setDelta = (delta) => {
      try { quill.setContents(delta); } catch (e) { setContent(''); }
    };
    const handleMessage = (event) => {
      let data;
      try { data = JSON.parse(event.data); } catch { return; }
      if (data.type === 'setContent') setContent(data.html);
      if (data.type === 'setDelta') setDelta(data.delta);
    };
    document.addEventListener('message', handleMessage);
    window.addEventListener('message', handleMessage);
  </script>
</body>
</html>
